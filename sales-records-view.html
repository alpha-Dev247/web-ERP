<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô + ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      background: #f3f4f6;
    }
    .form-section {
      background: white;
      border-radius: 1rem;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    label {
      display: block;
      margin-bottom: 0.25rem;
      font-weight: 500;
    }
    input, select, textarea {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      margin-bottom: 1rem;
    }
    button {
      background: #10b981;
      color: white;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 0.5rem;
      font-size: 1rem;
      cursor: pointer;
    }
    .message {
      font-weight: bold;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1 class="text-2xl font-bold mb-6">üìã ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô + ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h1>

  <div class="form-section">
    <h2 class="text-xl font-semibold mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
    <label>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</label>
    <input type="text" id="idCard">

    <label>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
    <input type="text" id="studentCode">

    <label>‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á</label>
    <input type="text" id="firstName">

    <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
    <input type="text" id="lastName">

    <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label>
    <input type="text" id="nickname">

    <label>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
    <input type="text" id="school">

    <label>Email</label>
    <input type="email" id="email">

    <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
    <input type="text" id="address">
  </div>

  <div class="form-section">
    <h2 class="text-xl font-semibold mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h2>
    <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
    <select id="studentStatus">
      <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
      <option value="‡πÉ‡∏´‡∏°‡πà">‡πÉ‡∏´‡∏°‡πà</option>
      <option value="‡πÄ‡∏Å‡πà‡∏≤">‡πÄ‡∏Å‡πà‡∏≤</option>
    </select>

    <label>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£</label>
    <input type="text" id="applicationType">

    <label>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label>
    <input type="text" id="academicYear">

    <label>‡∏™‡∏≤‡∏Ç‡∏≤</label>
    <input type="text" id="branch">

    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£</label>
    <input type="date" id="applicationDate">

    <label>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°</label>
    <input type="text" id="program">

    <label>‡∏ã‡∏µ‡∏ã‡∏±‡πà‡∏ô</label>
    <input type="text" id="season">

    <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö</label>
    <input type="text" id="classLevel">

    <label>‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô</label>
    <input type="text" id="promotion">

    <label>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©</label>
    <input type="text" id="discount">

    <label>‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏ö‡∏ö</label>
    <input type="text" id="paymentMethod">

    <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
    <textarea id="notes"></textarea>

    <label>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</label>
    <input type="text" id="totalAmount">

    <label>‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°</label>
    <input type="text" id="fees">

    <label>‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</label>
    <input type="text" id="netAmount">
  </div>

  <button onclick="submitForm()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>

  <div id="msgBox" class="message"></div>

  <script>
    const API_URL = "https://script.google.com/macros/s/PASTE_YOUR_DEPLOYED_URL_HERE/exec";

    async function submitForm() {
      const msgBox = document.getElementById("msgBox");

      const data = {
        "‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô": document.getElementById("idCard").value.trim(),
        "‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô": document.getElementById("studentCode").value.trim(),
        "‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á": document.getElementById("firstName").value.trim(),
        "‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•": document.getElementById("lastName").value.trim(),
        "‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô": document.getElementById("nickname").value.trim(),
        "‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô": document.getElementById("school").value.trim(),
        "Email": document.getElementById("email").value.trim(),
        "‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà": document.getElementById("address").value.trim(),

        "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô": document.getElementById("studentStatus").value.trim(),
        "‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£": document.getElementById("applicationType").value.trim(),
        "‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤": document.getElementById("academicYear").value.trim(),
        "‡∏™‡∏≤‡∏Ç‡∏≤": document.getElementById("branch").value.trim(),
        "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£": document.getElementById("applicationDate").value.trim(),
        "‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°": document.getElementById("program").value.trim(),
        "‡∏ã‡∏µ‡∏ã‡∏±‡πà‡∏ô": document.getElementById("season").value.trim(),
        "‡∏£‡∏∞‡∏î‡∏±‡∏ö": document.getElementById("classLevel").value.trim(),
        "‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô": document.getElementById("promotion").value.trim(),
        "‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©": document.getElementById("discount").value.trim(),
        "‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏ö‡∏ö": document.getElementById("paymentMethod").value.trim(),
        "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏": document.getElementById("notes").value.trim(),
        "‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°": document.getElementById("totalAmount").value.trim(),
        "‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°": document.getElementById("fees").value.trim(),
        "‡∏™‡∏∏‡∏ó‡∏ò‡∏¥": document.getElementById("netAmount").value.trim()
      };

      // Remove empty fields
      const filteredData = {};
      for (const key in data) {
        if (data[key]) {
          filteredData[key] = data[key];
        }
      }

      try {
        const response = await fetch(API_URL, {
          method: "POST",
          mode: "no-cors",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ data: filteredData })
        });

        const result = await response.json();
        if (result.success) {
          msgBox.textContent = "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!";
          msgBox.style.color = "green";
        } else {
          msgBox.textContent = "‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + result.error;
          msgBox.style.color = "red";
        }
      } catch (err) {
        msgBox.textContent = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err.message;
        msgBox.style.color = "red";
        console.error(err);
      }
    }
  </script>
</body>
</html>
