<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô + ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      background: #f3f4f6;
    }
    .form-section {
      background: white;
      border-radius: 1rem;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    label {
      display: block;
      margin-bottom: 0.25rem;
      font-weight: 500;
    }
    input, select, textarea {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      margin-bottom: 1rem;
    }
    button {
      background: #10b981;
      color: white;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 0.5rem;
      font-size: 1rem;
      cursor: pointer;
    }
    .message {
      font-weight: bold;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1 class="text-2xl font-bold mb-6">üìã ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô + ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h1>

  <div class="form-section">
  <h2 class="text-xl font-semibold mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>

  <label>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</label>
  <div class="flex gap-2">
    <input type="text" id="idCard" class="flex-1" />
    <button type="button" onclick="searchStudent()">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
  </div>

  <label>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
  <input type="text" id="studentCode" readonly />

  <label>‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á</label>
  <input type="text" id="firstName" readonly />

  <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
  <input type="text" id="lastName" readonly />

  <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label>
  <input type="text" id="nickname" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ" />

  <label>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
  <input type="text" id="school" />

  <label>Email</label>
  <input type="email" id="email" />

  <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
  <input type="text" id="address" />
</div>

  <div class="form-section">
    <h2 class="text-xl font-semibold mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h2>
    <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
    <select id="studentStatus">
      <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
      <option value="‡πÉ‡∏´‡∏°‡πà">‡πÉ‡∏´‡∏°‡πà</option>
      <option value="‡πÄ‡∏Å‡πà‡∏≤">‡πÄ‡∏Å‡πà‡∏≤</option>
    </select>

    <label>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£</label>
    <input type="text" id="applicationType">

    <label>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label>
    <input type="text" id="academicYear">

    <label>‡∏™‡∏≤‡∏Ç‡∏≤</label>
    <input type="text" id="branch">

    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£</label>
    <input type="date" id="applicationDate">

    <label>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°</label>
    <input type="text" id="program">

    <label>‡∏ã‡∏µ‡∏ã‡∏±‡πà‡∏ô</label>
    <input type="text" id="season">

    <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö</label>
    <input type="text" id="classLevel">

    <label>‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô</label>
    <input type="text" id="promotion">

    <label>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©</label>
    <input type="text" id="discount">

    <label>‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏ö‡∏ö</label>
    <input type="text" id="paymentMethod">

    <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
    <textarea id="notes"></textarea>

    <label>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</label>
    <input type="text" id="totalAmount">

    <label>‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°</label>
    <input type="text" id="fees">

    <label>‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</label>
    <input type="text" id="netAmount">
  </div>

  <button onclick="submitForm()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>

  <div id="msgBox" class="message"></div>

  <script>
  const API_URL = "https://script.google.com/macros/s/AKfycbxWy8oZXoHDLLIFmihUq3PeowAMzUCmD4hGSdvFJJJJBc_jLnZjQrHc0RCSWe64tKZj/exec";

  async function searchStudent() {
    const idCard = document.getElementById("idCard").value.trim();
    const msgBox = document.getElementById("msgBox");

    if (!idCard) {
      msgBox.textContent = "‚ùó ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤";
      msgBox.style.color = "orange";
      return;
    }

    try {
      const res = await fetch(`${API_URL}?idCard=${idCard}`);
      const data = await res.json();

      if (!data || data.error || !data["‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô"]) {
        msgBox.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö";
        msgBox.style.color = "red";
        clearStudentFields();
        return;
      }

      document.getElementById("studentCode").value = data["‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô"];
      document.getElementById("firstName").value = data["‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á"];
      document.getElementById("lastName").value = data["‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•"];
      document.getElementById("nickname").value = data["‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô"] || "";
      msgBox.textContent = "‚úÖ ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô";
      msgBox.style.color = "green";

    } catch (err) {
      console.error(err);
      msgBox.textContent = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠";
      msgBox.style.color = "red";
    }
  }

  function clearStudentFields() {
    document.getElementById("studentCode").value = "";
    document.getElementById("firstName").value = "";
    document.getElementById("lastName").value = "";
    document.getElementById("nickname").value = "";
  }
</script>

</body>
</html>
